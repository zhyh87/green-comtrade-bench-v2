FROM python:3.11-slim
WORKDIR /app

# Install curl for healthchecks
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# Copy pyproject.toml and source code
COPY pyproject.toml /app/
COPY src /app/src

# Install package and dependencies
RUN pip install --no-cache-dir .

ENV MOCK_URL=http://mock-comtrade:8000
ENV PURPLE_OUTPUT_ROOT=/workspace/purple_output
ENV PORT=9009

EXPOSE 9009

ENTRYPOINT ["python", "-m", "src.agent_a2a"]
CMD []
